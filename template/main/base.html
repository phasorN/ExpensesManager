{% load static %}

<!DOCTYPE html>
<html>
<head>
	{% block title_block %}
	{% endblock %}

	{% block extra_head_content %}
	{% endblock %}
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>
</head>
<body>
	<style type="text/css">
		body{
			/*background-image: url({% static 'back3.png' %});*/
		}
		.navbar-custom {
		    background-color: #087e8b!important;
		    opacity: 1;
		    color: white!important;
		    /*border-bottom: 1px black solid;*/
		}
		body{
			background-color: whitesmoke;
		}
		.nav-link{
			color: white!important;
		}
	</style>

	{% if confirmed == False %}
		<a href="{% url 'send_email_confirmation' %}" style="color: white"><div class="container-fluid btn btn-danger" style="border-radius: 0px">Confirm Your Email!</div></a>
	{% endif %}
	<nav class="navbar nav-default navbar-expand-lg navbar-dark navbar-custom">
		<div class="container">
			
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
				<span class="navbar-toggler-icon"></span>
			</button>

			<a class="navbar-brand" href="{% url 'index' %}" style="color: white!important">Home</a>

			{% if user.is_authenticated %}
			<ul class="nav navbar-nav">
				<li class="nav-item navbar-right" >
					<image id = "userImage" height = "50px" width = "50px" style="border:2px solid white; border-radius: 25px" >
				</li>
			</ul>
			{% else %}
			<ul class="nav navbar-nav">
				<li>
					<a href="{% url 'main:user_login' %}" class="nav-link">Login</a>
				</li>
			</ul>
			{% endif %}

		</div>
	</nav>

	<div class="collapse container navbar-custom" id="collapsibleNavbar" style="border-bottom: 1px solid black;">
		<ul class="navbar-nav">

			{% if user.is_authenticated %}
			<li>
				<a href="{% url 'main:expense_list' %}" class="nav-link" >List Expenses</a>
			</li>
			<li>
				<a href="{% url 'main:add_expense' %}" class="nav-link">Add Expense</a>
			</li>
			<li>
				<a href="{% url 'main:change_password' %}" class="nav-link">Change Password</a>
			</li>
			<li>
				<a href="{% url 'main:user_logout' %}" class="nav-link">Logout</a>
			</li>
			{% else %}
			<li>
				<a style="color: white;" class = "nav-link" href="{% url 'main:user_login' %}">Login</a>
			</li>
			<li>
				<a href="{% url 'main:user_registration' %}" class="nav-link">Sign Up</a>
			</li>
			{% endif %}
			
		</ul>
	</div>

	<canvas id="myCanvas" width="500" height="500" style="border:2px solid #000000; display: none;"></canvas>

	<br>
	<div class="container">

		{% block body_block %}
		{% endblock %}
	</div>

	{% if user.is_authenticated %}
	<script>

		var canvas = document.getElementById('myCanvas');
		canvas.style.display = "none";
		var ctx = canvas.getContext("2d");
		ctx.fillStyle = "white";
		ctx.textAlign = "center"

		{% if user.first_name and user.last_name %}
			ctx.font = "250px monospace";
			var initials = "{{ user.first_name|first }}{{ user.last_name|first }}"
			ctx.fillText(initials, 250, 330); 

		{% elif user.username %}
			ctx.font = "400px monospace";
			var initials = "{{ user.username|first }}"
			ctx.fillText(initials, 250, 360); 
		{% endif %}

		
		var fullQuality = canvas.toDataURL();
		// alert(fullQuality)
		var uImage = document.getElementById('userImage');
		uImage.src = fullQuality;
	</script>
	{% endif %}

</body>
</html>