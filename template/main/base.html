<!DOCTYPE html>
<html>
<head>
	{% block title_block %}
	{% endblock %}

	{% block extra_head_content %}
	{% endblock %}
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>
</head>
<body>
	<style type="text/css">
/*		.navbar-custom {
		    background-color: rgba(50, 50, 50, 1);
		    opacity: 0.8;
		}*/
		body{
			background-color: whitesmoke;
		}
	</style>
	<style>
.dropbtn {
    border: none;
}
/*
.dropdown {
    position: relative;
    display: inline-block;
}*/

.dropdown-content {
    display: none;
    position: absolute;
    background-color: #f1f1f1;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    z-index: 1;
}

.dropdown-content a {
    color: black;
    padding: 10px;
    text-decoration: none;
    display: block;
}

.dropdown-content a:hover {background-color: #ddd;}

.dropdown:hover .dropdown-content {display: block;}

.dropdown:hover .dropbtn {background-color: #3e8e41;}
</style>

	{% if confirmed == False %}
		<div class="container-fluid btn btn-danger" style="border-radius: 0px"><a href="{% url 'send_email_confirmation' %}" style="color: white">Confirm Your Email!</a></div>
	{% endif %}
	<nav class="navbar nav-default navbar-expand-lg navbar-dark bg-dark">
		<div class="container">
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
				<span class="navbar-toggler-icon"></span>
			</button>

			<a class="navbar-brand ml-auto" href="{% url 'index' %}">Home</a>

			<div class="collapse navbar-collapse" id="collapsibleNavbar">
				<ul class="navbar-nav">
					<li class="nav-item">
						<a href="{% url 'main:expense_list' %}" class="nav-link">List</a>
					</li>
					<li class="nav-item">
						<a href="{% url 'main:add_expense' %}" class="nav-link">New</a>
					</li>
					<li class="nav-item">
						<a href="{% url 'main:filter_by_date' %}" class="nav-link">FilterByDate</a>
					</li>
					{% if not user.is_authenticated %}
					<li class="nav-item">
						<a href="{% url 'main:user_registration' %}" class="nav-link">Sign Up</a>
					</li>
					{% endif %}
				</ul>
			</div>

			<ul class="nav navbar-nav ml-auto">
				{% if user.is_authenticated %}
					<li class="nav-item navbar-right" >
						<!-- <a style="color: white;" class = "nav-link" href="{% url 'main:user_logout' %}">
							Logout
						</a> -->
							<div class="dropdown">
								<image class="dropbtn" id = "userImage" height = "50px" width = "50px" style="border:2px solid white; border-radius: 25px" >
								<span class="dropdown-content">
									<a href="{% url 'main:user_logout' %}">Logout</a>
								</span>
							</div>
					</li>
				{% else %}
					<li class="nav-item navbar-right" >
						<a style="color: white;" class = "nav-link" href="{% url 'main:user_login' %}">Login</a>
					</li>
				{% endif %}
			</ul>

		</div>
	</nav>
	<canvas id="myCanvas" width="500" height="500" style="border:2px solid #000000; display: none;"></canvas>

	<br>
	<div class="container">

		{% block body_block %}
		{% endblock %}
	</div>

	{% if user.is_authenticated %}
	<script>

		var canvas = document.getElementById('myCanvas');
		canvas.style.display = "none";
		var ctx = canvas.getContext("2d");
		ctx.fillStyle = "white";
		ctx.textAlign = "center"

		{% if user.first_name and user.last_name %}
			ctx.font = "250px monospace";
			var initials = "{{ user.first_name|first }}{{ user.last_name|first }}"
			ctx.fillText(initials, 250, 330); 

		{% elif user.username %}
			ctx.font = "400px monospace";
			var initials = "{{ user.username|first }}"
			ctx.fillText(initials, 250, 360); 
		{% endif %}

		
		var fullQuality = canvas.toDataURL();
		// alert(fullQuality)
		var uImage = document.getElementById('userImage');
		uImage.src = fullQuality;
	</script>
	{% endif %}

</body>
</html>